# DOKUMENTACJA PROJEKTU GYMPROGRESS

## SPIS TRE≈öCI
1. [PRZEGLƒÑD PROJEKTU](#przeglƒÖd-projektu)
2. [ARCHITEKTURA TECHNICZNA](#architektura-techniczna)
3. [STRUKTURA APLIKACJI](#struktura-aplikacji)
4. [ROLE U≈ªYTKOWNIK√ìW I FUNKCJONALNO≈öCI](#role-u≈ºytkownik√≥w-i-funkcjonalno≈õci)
5. [MODELE DANYCH](#modele-danych)
6. [API I ENDPOINTY](#api-i-endpointy)
7. [AUTENTYFIKACJA I AUTORYZACJA](#autentyfikacja-i-autoryzacja)
8. [KOMPONENTY UI](#komponenty-ui)
9. [KONFIGURACJA I ≈öRODOWISKO](#konfiguracja-i-≈õrodowisko)
10. [INSTRUKCJE ROZWOJU](#instrukcje-rozwoju)
11. [FUNKCJONALNO≈öCI SZCZEG√ì≈ÅOWE](#funkcjonalno≈õci-szczeg√≥≈Çowe)
12. [BEZPIECZE≈ÉSTWO](#bezpiecze≈Ñstwo)
13. [WYDAJNO≈öƒÜ I SKALOWANIE](#wydajno≈õƒá-i-skalowanie)
14. [TESTOWANIE](#testowanie)
15. [WDRO≈ªENIE](#wdro≈ºenie)

---

## PRZEGLƒÑD PROJEKTU

**GymProgress** to kompleksowa aplikacja webowa do zarzƒÖdzania treningami fitness, zaprojektowana dla trzech r√≥≈ºnych r√≥l u≈ºytkownik√≥w: sportowc√≥w, trener√≥w personalnych i administrator√≥w. Aplikacja umo≈ºliwia ≈õledzenie postƒôp√≥w, planowanie trening√≥w, zarzƒÖdzanie dietƒÖ oraz komunikacjƒô miƒôdzy trenerami a sportowcami.

### G≈Ç√≥wne Funkcjonalno≈õci:
- ü§ñ **Planowanie trening√≥w z wykorzystaniem AI** (Google GenAI/Genkit)
- üìö **Rozbudowana biblioteka ƒáwicze≈Ñ** z mo≈ºliwo≈õciƒÖ dodawania w≈Çasnych
- üìÖ **Kalendarz treningowy** z wizualizacjƒÖ plan√≥w
- üìä **≈öledzenie postƒôp√≥w** z wykresami i statystykami
- üéØ **System cel√≥w i osiƒÖgniƒôƒá**
- üí¨ **System czatu** miƒôdzy trenerami a sportowcami
- üèÉ‚Äç‚ôÇÔ∏è **≈öledzenie biegania** z GPS
- ü•ó **ZarzƒÖdzanie dietƒÖ** z kalkulatorem kalorii
- üìè **Pomiary cia≈Ça** z wizualizacjƒÖ zmian
- üó∫Ô∏è **Mapa si≈Çowni** z integracjƒÖ Google Maps
- üìñ **Strefa wiedzy** z artyku≈Çami edukacyjnymi

### Technologie Kluczowe:
- **Frontend**: Next.js 15, React 18, TypeScript
- **Styling**: Tailwind CSS, shadcn/ui, Radix UI
- **Backend**: Next.js API Routes, MongoDB, Mongoose
- **Autentyfikacja**: NextAuth.js z MongoDB Adapter
- **AI**: Google GenAI, Genkit AI
- **Mapy**: Google Maps API
- **Formularze**: React Hook Form, Zod validation

---

## ARCHITEKTURA TECHNICZNA

### Stack Technologiczny:

#### Frontend:
- **Next.js 15.3.3** - Framework React z renderowaniem hybrydowym
- **React 18.3.1** - Biblioteka UI z najnowszymi hook'ami
- **TypeScript 5** - Typowanie statyczne
- **Tailwind CSS 3.4.1** - Utility-first CSS framework
- **shadcn/ui** - Komponenty UI oparte na Radix UI
- **Lucide React** - Zestaw ikon SVG

#### Backend:
- **Next.js API Routes** - Serverless API endpoints
- **MongoDB 6.20.0** - NoSQL baza danych
- **Mongoose 8.19.2** - ODM dla MongoDB
- **NextAuth.js 4.24.13** - System autentyfikacji
- **bcryptjs** - Hashowanie hase≈Ç
- **JWT** - JSON Web Tokens

#### AI i Analityka:
- **@genkit-ai/google-genai** - Integracja z Google AI
- **@genkit-ai/next** - Genkit dla Next.js
- **genkit-cli** - CLI dla Genkit AI

#### Inne Integracje:
- **@react-google-maps/api** - Google Maps integration
- **Recharts** - Biblioteka wykres√≥w
- **date-fns** - Manipulacja datami

### Architektura Folder√≥w:

```
src/
‚îú‚îÄ‚îÄ app/                    # Next.js App Router
‚îÇ   ‚îú‚îÄ‚îÄ (admin)/           # Admin panel (route group)
‚îÇ   ‚îú‚îÄ‚îÄ (athlete)/         # Panel sportowca
‚îÇ   ‚îú‚îÄ‚îÄ (trainer)/         # Panel trenera
‚îÇ   ‚îú‚îÄ‚îÄ (app)/            # Wsp√≥lne komponenty aplikacji
‚îÇ   ‚îú‚îÄ‚îÄ api/              # API routes
‚îÇ   ‚îú‚îÄ‚îÄ login/            # Strona logowania
‚îÇ   ‚îú‚îÄ‚îÄ register/         # Strona rejestracji
‚îÇ   ‚îî‚îÄ‚îÄ globals.css       # Globalne style
‚îú‚îÄ‚îÄ components/            # Komponenty React
‚îÇ   ‚îú‚îÄ‚îÄ ui/               # Komponenty UI (shadcn/ui)
‚îÇ   ‚îú‚îÄ‚îÄ nav.tsx           # Nawigacja g≈Ç√≥wna
‚îÇ   ‚îú‚îÄ‚îÄ header.tsx        # Nag≈Ç√≥wek
‚îÇ   ‚îî‚îÄ‚îÄ theme-provider.tsx # Provider motywu
‚îú‚îÄ‚îÄ hooks/                # Custom hooks
‚îú‚îÄ‚îÄ lib/                  # Utility functions i helpers
‚îú‚îÄ‚îÄ models/               # Modele danych (Mongoose)
‚îî‚îÄ‚îÄ ai/                   # Konfiguracja AI i flows
```

---

## STRUKTURA APLIKACJI

### Route Groups (Next.js 13+):

#### 1. Landing Page (`/`)
- Strona g≈Ç√≥wna dla niezalogowanych u≈ºytkownik√≥w
- Prezentacja funkcjonalno≈õci aplikacji
- Przekierowanie na odpowiedni dashboard na podstawie roli

#### 2. Admin Panel (`/(admin)`)
**≈öcie≈ºka bazowa**: `/admin`

**Strony**:
- `/admin/dashboard` - Dashboard administratora
- `/admin/users` - ZarzƒÖdzanie u≈ºytkownikami
- `/admin/exercises` - Wszystkie ƒáwiczenia w systemie
- `/admin/workout-plans` - Wszystkie plany treningowe
- `/admin/articles` - Wszystkie artyku≈Çy
- `/admin/muscle-groups` - Grupy miƒô≈õniowe
- `/admin/gyms` - ZarzƒÖdzanie si≈Çowniami
- `/admin/profile` - Profil administratora

#### 3. Panel Trenera (`/(trainer)`)
**≈öcie≈ºka bazowa**: `/trainer`

**Strony**:
- `/trainer/dashboard` - Dashboard trenera
- `/trainer/my-athletes` - Lista sportowc√≥w trenera
- `/trainer/my-athletes/[athleteId]` - Szczeg√≥≈Çy sportowca
- `/trainer/chat` - Czat z sportowcami
- `/trainer/templates` - Plany treningowe trenera
- `/trainer/exercises` - ƒÜwiczenia trenera
- `/trainer/diet` - Diety trenera
- `/trainer/knowledge-zone` - Artyku≈Çy trenera
- `/trainer/knowledge-zone/manage` - ZarzƒÖdzanie artyku≈Çami
- `/trainer/knowledge-zone/[articleId]` - Szczeg√≥≈Çy artyku≈Çu
- `/trainer/map` - Mapa si≈Çowni
- `/trainer/profile` - Profil trenera

#### 4. Panel Sportowca (`/(athlete)`)
**≈öcie≈ºka bazowa**: `/athlete`

**Strony**:
- `/athlete/dashboard` - Dashboard sportowca
- `/athlete/log` - Logowanie treningu
- `/athlete/calendar` - Kalendarz treningowy
- `/athlete/chat` - Czat z trenerem
- `/athlete/templates` - Plany treningowe
- `/athlete/exercises` - Biblioteka ƒáwicze≈Ñ
- `/athlete/running` - ≈öledzenie biegania
- `/athlete/diet` - ZarzƒÖdzanie dietƒÖ
- `/athlete/measurements` - Pomiary cia≈Ça
- `/athlete/history` - Historia trening√≥w
- `/athlete/history/[sessionId]` - Szczeg√≥≈Çy sesji
- `/athlete/goals` - Cele i trofea
- `/athlete/knowledge-zone` - Strefa wiedzy
- `/athlete/knowledge-zone/[articleId]` - Szczeg√≥≈Çy artyku≈Çu
- `/athlete/map` - Mapa si≈Çowni
- `/athlete/profile` - Profil sportowca

---

## ROLE U≈ªYTKOWNIK√ìW I FUNKCJONALNO≈öCI

### 1. Administrator (`admin`)

**Uprawnienia**:
- Pe≈Çny dostƒôp do wszystkich danych systemowych
- ZarzƒÖdzanie u≈ºytkownikami (sportowcy, trenerzy)
- Moderacja tre≈õci (artyku≈Çy, ƒáwiczenia)
- Konfiguracja systemu (grupy miƒô≈õniowe, si≈Çownie)
- Analityka i raporty systemowe

**Funkcjonalno≈õci**:
- Dashboard z kluczowymi metrykami
- CRUD operacje na wszystkich encjach
- System uprawnie≈Ñ i r√≥l
- Monitoring aktywno≈õci u≈ºytkownik√≥w
- ZarzƒÖdzanie tre≈õciƒÖ edukacyjnƒÖ

### 2. Trener (`trainer`)

**Uprawnienia**:
- ZarzƒÖdzanie przypisanymi sportowcami
- Tworzenie i edycja plan√≥w treningowych
- Monitoring postƒôp√≥w sportowc√≥w
- Komunikacja ze sportowcami
- Tworzenie tre≈õci edukacyjnych

**Funkcjonalno≈õci**:
- Dashboard z postƒôpami sportowc√≥w
- System czatu z sportowcami
- Kreator plan√≥w treningowych z AI
- Biblioteka ƒáwicze≈Ñ (w≈Çasne i systemowe)
- Analiza postƒôp√≥w sportowc√≥w
- Tworzenie artyku≈Ç√≥w edukacyjnych
- ZarzƒÖdzanie ≈ºƒÖdaniami wsp√≥≈Çpracy

### 3. Sportowiec/Atlet (`athlete`)

**Uprawnienia**:
- Dostƒôp do w≈Çasnych danych treningowych
- Komunikacja z przypisanym trenerem
- Logowanie trening√≥w i pomiar√≥w
- PrzeglƒÖdanie plan√≥w treningowych
- Dostƒôp do tre≈õci edukacyjnych

**Funkcjonalno≈õci**:
- Dashboard z osobistymi statystykami
- Logowanie trening√≥w si≈Çowych i cardio
- Kalendarz treningowy
- System cel√≥w i osiƒÖgniƒôƒá
- ≈öledzenie diety i kalorii
- Pomiary cia≈Ça z wizualizacjƒÖ
- Historia trening√≥w z analizƒÖ
- Czat z trenerem
- Mapa si≈Çowni w okolicy
- Biblioteka wiedzy fitness

---

## MODELE DANYCH

### UserProfile
```typescript
type UserProfile = {
  id: string;
  name: string;
  email: string;
  role: 'athlete' | 'trainer' | 'admin';
  location?: string;
  socialLinks?: {
    instagram?: string;
    facebook?: string;
    twitter?: string;
  };
  trainerId?: string; // Dla sportowc√≥w
  favoriteGymIds?: string[];
}
```

### Exercise
```typescript
type Exercise = {
  id: string;
  name: string;
  muscleGroup: string;
  description: string;
  image: string;
  imageHint: string;
  ownerId?: string; // W≈Çasne ƒáwiczenia
  type: 'weight' | 'duration' | 'reps';
}
```

### WorkoutLog
```typescript
type WorkoutLog = {
  id: string;
  endTime: Timestamp;
  workoutName: string;
  duration?: number; // w minutach
  exercises: WorkoutExerciseLog[];
  photoURL?: string;
  athleteId: string;
  status?: 'in-progress' | 'completed';
  startTime?: Timestamp;
  feedback?: string;
}
```

### WorkoutPlan
```typescript
type WorkoutPlan = {
  id: string;
  name: string;
  description: string;
  trainerId: string;
  assignedAthleteIds: string[];
  workoutDays: WorkoutDay[];
}
```

### Article
```typescript
type Article = {
  id: string;
  title: string;
  content: string;
  authorId: string;
  authorName: string;
  category: string;
  createdAt: Timestamp;
  updatedAt?: Timestamp;
  status: 'published' | 'draft';
  coverImageUrl?: string;
  imageHint?: string;
}
```

### Conversation & Message
```typescript
type Conversation = {
  id: string;
  participants: string[];
  trainerId: string;
  athleteId: string;
  trainerName: string;
  athleteName: string;
  lastMessage: {
    text: string;
    senderId: string;
    createdAt: Timestamp;
  } | null;
  updatedAt: Timestamp;
  unreadCount?: {
    [userId: string]: number;
  };
}

type Message = {
  id: string;
  conversationId: string;
  senderId: string;
  text: string;
  createdAt: Timestamp;
}
```

### BodyMeasurement
```typescript
type BodyMeasurement = {
  id: string;
  ownerId: string;
  date: Timestamp;
  weight: number; // kg
  circumferences: {
    biceps?: number; // cm
    chest?: number;
    waist?: number;
    hips?: number;
    thigh?: number;
  };
  photoURLs?: string[];
  sharedWithTrainer: boolean;
}
```

### RunningSession
```typescript
type RunningSession = {
  id: string;
  date: Timestamp;
  distance: number; // km
  duration: number; // minuty
  avgPace: number; // min/km
  notes?: string;
  ownerId: string;
}
```

### Goal
```typescript
type Goal = {
  id: string;
  title: string;
  target: number;
  current: number;
  unit: string;
  deadline: Timestamp;
  ownerId: string;
}
```

---

## API I ENDPOINTY

### Struktura API Routes

#### Autentyfikacja (`/api/auth/`)
- `POST /api/auth/register` - Rejestracja nowego u≈ºytkownika
- `[...nextauth]` - NextAuth.js handlers (login, callback, session)

**Przyk≈Çad rejestracji**:
```typescript
// POST /api/auth/register
{
  "name": "Jan Kowalski",
  "email": "jan@example.com",
  "password": "password123",
  "role": "athlete"
}
```

#### Generic Database API (`/api/db/`)

**Pattern**: `/api/db/[collection]/[id]?`

**Obs≈Çugiwane kolekcje**:
- `users` - Profile u≈ºytkownik√≥w
- `exercises` - ƒÜwiczenia
- `workout-logs` - Logi trening√≥w
- `workout-plans` - Plany treningowe
- `articles` - Artyku≈Çy
- `conversations` - Konwersacje
- `messages` - Wiadomo≈õci
- `body-measurements` - Pomiary cia≈Ça
- `running-sessions` - Sesje biegowe
- `goals` - Cele
- `muscle-groups` - Grupy miƒô≈õniowe
- `gyms` - Si≈Çownie

**Dostƒôpne operacje**:
```typescript
// GET /api/db/[collection] - Lista dokument√≥w
// GET /api/db/[collection]/[id] - Pojedynczy dokument
// POST /api/db/[collection] - Tworzenie nowego
// PUT /api/db/[collection]/[id] - Aktualizacja
// DELETE /api/db/[collection]/[id] - Usuwanie
```

**Query Parameters**:
- `?owner=userId` - Filtrowanie po w≈Ça≈õcicielu
- `?trainerId=id` - Filtrowanie po trenerze
- `?athleteId=id` - Filtrowanie po sportowcu
- `?category=name` - Filtrowanie po kategorii
- `?status=published|draft` - Filtrowanie po statusie
- `?limit=10` - Limit wynik√≥w
- `?skip=20` - Paginacja

**Przyk≈Çady u≈ºycia**:
```typescript
// Pobranie trening√≥w sportowca
GET /api/db/workout-logs?owner=userId

// Pobranie sportowc√≥w trenera
GET /api/db/users?trainerId=trainerId&role=athlete

// Utworzenie nowego ƒáwiczenia
POST /api/db/exercises
{
  "name": "Wyciskanie sztangi",
  "muscleGroup": "chest",
  "type": "weight",
  "description": "...",
  "ownerId": "userId"
}
```

---

## AUTENTYFIKACJA I AUTORYZACJA

### NextAuth.js Configuration

**Providers**:
- Credentials Provider (email/password)
- Integracja z MongoDB Adapter
- Session strategy: JWT

**Flow autentyfikacji**:
1. U≈ºytkownik loguje siƒô przez formularz
2. Credentials provider sprawdza dane w MongoDB
3. Po udanej autentyfikacji tworzona jest sesja JWT
4. Frontend przechowuje token w cookies
5. API routes weryfikujƒÖ token przy ka≈ºdym ≈ºƒÖdaniu

### MongoDB Authentication Hooks

**Custom hooks dla MongoDB**:
```typescript
// lib/db-hooks.tsx
export const useUser = () => {
  // NextAuth session + MongoDB user data
  const { data: session, status } = useSession();
  const [user, setUser] = useState(null);

  useEffect(() => {
    if (session?.user) {
      // Fetch complete user profile from MongoDB
      fetchUserProfile(session.user.id);
    }
  }, [session]);

  return { user, isLoading: status === 'loading' };
};

export const useDoc = (collection: string, id: string | null) => {
  // MongoDB document hook
  const [data, setData] = useState(null);
  const [isLoading, setIsLoading] = useState(true);

  useEffect(() => {
    if (id) {
      fetch(`/api/db/${collection}/${id}`)
        .then(res => res.json())
        .then(setData)
        .finally(() => setIsLoading(false));
    }
  }, [collection, id]);

  return { data, isLoading };
};
```

**Funkcje autentyfikacji**:
- `useUser()` - Current user state z NextAuth + MongoDB
- `useDoc(collection, id)` - Document hook z autoryzacjƒÖ
- `useCollection(collection)` - Collection hook z filtrami
- `signOut()` - Logout przez NextAuth

### Autoryzacja na poziomie route'√≥w

**Middleware sprawdza**:
- Czy u≈ºytkownik jest zalogowany
- Czy ma odpowiedniƒÖ rolƒô dla danej ≈õcie≈ºki
- Przekierowuje na login lub unauthorized

**Route Guards**:
- `/(admin)/*` - Tylko admin
- `/(trainer)/*` - Tylko trainer
- `/(athlete)/*` - Tylko athlete

---

## KOMPONENTY UI

### Design System - shadcn/ui

**Komponenty bazowe**:
- `Button` - R√≥≈ºne warianty i rozmiary
- `Card` - Karty z header/content/footer
- `Form` - Formularze z validacjƒÖ
- `Input`, `Textarea` - Pola tekstowe
- `Select`, `Checkbox`, `RadioGroup` - Controls
- `Dialog`, `Sheet` - Modalne okna
- `Table` - Tabele z sortowaniem
- `Badge`, `Avatar` - Elementy wizualne

**Layout komponenty**:
- `Sidebar` - Boczna nawigacja z kolapsowaniem
- `Header` - G√≥rny pasek z breadcrumbs
- `Tabs` - Zak≈Çadki
- `Accordion`, `Collapsible` - Sk≈Çadane elementy

**Specjalistyczne**:
- `Calendar` - Kalendarz z react-day-picker
- `Chart` - Wykresy z recharts
- `Progress` - Paski postƒôpu
- `Slider` - Suwaki warto≈õci
- `Toast` - Notyfikacje

### Nawigacja (nav.tsx)

**Adaptacyjna nawigacja** na podstawie roli:

**Athlete Navigation**:
```typescript
const athleteNavItems = [
  { href: '/athlete/dashboard', icon: LayoutDashboard, label: 'Panel Sportowca' },
  { href: '/athlete/log', icon: PlusSquare, label: 'Zapisz Trening' },
  { href: '/athlete/calendar', icon: CalendarDays, label: 'Kalendarz' },
  // ... wiƒôcej pozycji
];
```

**Features**:
- Aktywne zaznaczanie bie≈ºƒÖcej strony
- Tooltips dla zminimalizowanego sidebar
- Badge z liczbƒÖ nieprzeczytanych wiadomo≈õci
- Avatar z inicja≈Çami u≈ºytkownika
- Responsywny design (mobile drawer)

### Theme Provider

**Obs≈Çuga motyw√≥w**:
- Light/Dark mode z next-themes
- Automatyczne wykrywanie preferencji systemu
- Persistentne przechowywanie wyboru
- Smooth transitions miƒôdzy motywami

### Formularze z React Hook Form

**Pattern**:
```typescript
const form = useForm<FormData>({
  resolver: zodResolver(schema),
  defaultValues: {...}
});

const onSubmit = async (data: FormData) => {
  // API call
};
```

**Validacja z Zod**:
- Type-safe schemas
- Internationalized error messages
- Custom validators
- Async validation support

---

## KONFIGURACJA I ≈öRODOWISKO

### Package.json Scripts

```json
{
  "scripts": {
    "dev": "next dev --turbopack -p 9002",
    "build": "NODE_ENV=production next build",
    "start": "next start",
    "lint": "next lint",
    "typecheck": "tsc --noEmit"
  }
}
```

### Turbopack Integration

**Wykorzystanie**:
- Turbopack dla development server
- Znacznie szybsze hot reload
- Lepsze tree shaking
- Optymalizacja bundlingu

### Environment Variables

**Wymagane zmienne**:
```env
# MongoDB
MONGODB_URI=mongodb://localhost:27017/gymprogressnext
MONGODB_DB=gymprogressnext

# NextAuth
NEXTAUTH_URL=http://localhost:9002
NEXTAUTH_SECRET=your-secret-key

# Google Maps (opcjonalne)
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=your-api-key

# Google AI
GOOGLE_GENAI_API_KEY=your-genai-key

# File Upload (opcjonalne)
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=10485760
```

### TypeScript Configuration

**tsconfig.json highlights**:
- Strict mode enabled
- Path aliases (@/components, @/lib)
- Next.js optimizations
- Module resolution: bundler

### Tailwind CSS Config

**Rozszerzenia**:
```javascript
module.exports = {
  // shadcn/ui theming
  extend: {
    colors: {
      border: "hsl(var(--border))",
      primary: "hsl(var(--primary))",
      // ... design tokens
    },
    fontFamily: {
      headline: ['var(--font-headline)'],
      // ...
    }
  },
  plugins: [require("tailwindcss-animate")]
}
```

---

## INSTRUKCJE ROZWOJU

### Rozpoczƒôcie pracy

1. **Klonowanie projektu**:
```bash
git clone [repository-url]
cd kluska-monolith
```

2. **Instalacja zale≈ºno≈õci**:
```bash
npm install
# lub
yarn install
```

3. **Konfiguracja ≈õrodowiska**:
```bash
cp .env.example .env.local
# Uzupe≈Çnij zmienne ≈õrodowiskowe
```

4. **Uruchomienie bazy danych**:
```bash
# MongoDB lokalnie
mongod

# Lub MongoDB Atlas (cloud)
# Ustaw MONGODB_URI w .env.local
```

5. **Start development server**:
```bash
npm run dev
```

Aplikacja dostƒôpna pod: `http://localhost:9002`

### Development Workflow

**Struktura commit√≥w**:
- `feat:` - nowe funkcjonalno≈õci
- `fix:` - poprawki b≈Çƒôd√≥w
- `docs:` - dokumentacja
- `style:` - formatowanie kodu
- `refactor:` - refaktoring
- `test:` - testy

**Branch strategy**:
- `main` - production branch
- `develop` - development branch
- `feature/*` - feature branches
- `hotfix/*` - emergency fixes

### Dodawanie nowych funkcjonalno≈õci

**1. Nowy route**:
```bash
mkdir src/app/(role)/route-name
touch src/app/(role)/route-name/page.tsx
```

**2. Nowy model danych**:
```bash
# Dodaj typ w src/lib/types.ts
# Dodaj model Mongoose w src/models/
# Aktualizuj API routes w src/app/api/db/
```

**3. Nowy komponent UI**:
```bash
# Wykorzystaj shadcn/ui CLI
npx shadcn-ui@latest add [component-name]
```

**4. Nowy hook**:
```bash
touch src/hooks/use-[hook-name].tsx
```

### Debugowanie

**Development tools**:
- Next.js DevTools
- React DevTools
- Network tab (API calls)
- MongoDB Compass
- Firebase Console

**Logowanie**:
```typescript
console.log('Development:', process.env.NODE_ENV);
console.table(data); // Strukturalne dane
console.group('API Call'); // Grupowane logi
```

---

## FUNKCJONALNO≈öCI SZCZEG√ì≈ÅOWE

### 1. Planowanie Trening√≥w z AI

**Google Genkit Integration**:
```typescript
// src/ai/flows/workout-flow.ts
import { genkit } from 'genkit';
import { googleGenAI } from '@genkit-ai/google-genai';

export const generateWorkoutPlan = genkit({
  model: googleGenAI('gemini-pro'),
  input: z.object({
    goals: z.array(z.string()),
    experience: z.enum(['beginner', 'intermediate', 'advanced']),
    availableDays: z.number(),
    equipment: z.array(z.string())
  }),
  output: z.object({
    planName: z.string(),
    description: z.string(),
    workoutDays: z.array(workoutDaySchema)
  })
});
```

**Flow**:
1. Sportowiec wype≈Çnia preferencje treningowe
2. AI generuje spersonalizowany plan
3. Trener mo≈ºe zaakceptowaƒá/zmodyfikowaƒá
4. Plan przypisywany do sportowca
5. Automatyczne ≈õledzenie postƒôp√≥w

### 2. System Czatu

**Real-time komunikacja**:
- Konwersacje miƒôdzy trenerem a sportowcami
- Notyfikacje o nowych wiadomo≈õciach
- Historia wszystkich rozm√≥w
- Mo≈ºliwo≈õƒá wysy≈Çania zdjƒôƒá

**Implementacja**:
```typescript
// Wys≈Çanie wiadomo≈õci
const sendMessage = async (conversationId: string, text: string) => {
  await fetch(`/api/db/messages`, {
    method: 'POST',
    body: JSON.stringify({
      conversationId,
      senderId: user.uid,
      text,
      createdAt: new Date()
    })
  });

  // Aktualizacja konwersacji
  await updateConversation(conversationId, { lastMessage: {...} });
};
```

### 3. ≈öledzenie Postƒôp√≥w

**Metryki**:
- Objƒôto≈õƒá treningowa (sets √ó reps √ó weight)
- Czas spƒôdzony na treningu
- Czƒôstotliwo≈õƒá trening√≥w
- Postƒôp w konkretnych ƒáwiczeniach
- Zmiany masy cia≈Ça i obwod√≥w

**Wizualizacja**:
- Wykresy liniowe (postƒôp w czasie)
- Wykresy s≈Çupkowe (por√≥wnanie okres√≥w)
- Heat mapy (aktywno≈õƒá kalendarzowa)
- Pie charts (rozk≈Çad grup miƒô≈õniowych)

### 4. Biblioteka ƒÜwicze≈Ñ

**Kategoryzacja**:
- Grupy miƒô≈õniowe
- Typ sprzƒôtu
- Poziom trudno≈õci
- W≈Çasne vs. systemowe

**Features**:
- Wyszukiwanie i filtrowanie
- Dodawanie w≈Çasnych ƒáwicze≈Ñ
- Opisy i instrukcje wideo
- Historia wykonywania

### 5. Kalendarz Treningowy

**Funkcjonalno≈õci**:
- Planowanie trening√≥w na przysz≈Çe dni
- Widok miesiƒôczny/tygodniowy/dzienny
- Drag & drop przeplanowywanie
- Powiadomienia o nadchodzƒÖcych treningach
- Integracja z planami treningowymi

### 6. ZarzƒÖdzanie DietƒÖ

**FatSecret API Integration**:
```typescript
// src/ai/flows/fatsecret-flow.ts
export const searchFood = async (query: string) => {
  // Po≈ÇƒÖczenie z FatSecret API
  // Zwr√≥cenie informacji nutricyjnych
};
```

**Funkcje**:
- Baza danych produkt√≥w spo≈ºywczych
- Kalkulator kalorii i makrosk≈Çadnik√≥w
- Dziennik posi≈Çk√≥w
- Cele ≈ºywieniowe
- Analiza tygodniowa/miesiƒôczna

### 7. Pomiary Cia≈Ça

**≈öledzenie**:
- Waga cia≈Ça
- Obwody (biceps, klatka, talia, biodra, udo)
- Zdjƒôcia progress
- Udostƒôpnianie trenerowi

**Wizualizacja postƒôp√≥w**:
- Wykresy zmian w czasie
- Por√≥wnanie zdjƒôƒá "przed i po"
- Automatyczne obliczanie BMI
- Eksport danych

### 8. Mapa Si≈Çowni

**Google Maps Integration**:
```typescript
const { isLoaded } = useJsApiLoader({
  id: 'google-map-script',
  googleMapsApiKey: process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY!
});

// Wyszukiwanie si≈Çowni w okolicy
const searchGyms = (location: LatLng) => {
  const service = new google.maps.places.PlacesService(mapRef.current!);
  service.nearbySearch({
    location,
    radius: 5000,
    type: 'gym'
  }, callback);
};
```

### 9. Strefa Wiedzy

**System artyku≈Ç√≥w**:
- Tworzenie przez trener√≥w i admin√≥w
- Kategorie tematyczne
- Rich text editor
- SEO optimization
- System komentarzy

**Kategorie artyku≈Ç√≥w**:
- Trening si≈Çowy
- Cardio i kondycja
- Dieta i ≈ºywienie
- Regeneracja
- Suplementacja
- Anatomia i fizjologia

### 10. System Cel√≥w i OsiƒÖgniƒôƒá

**Rodzaje cel√≥w**:
- Cele wagowe (utrata/przyrost wagi)
- Cele si≈Çowe (konkretne ciƒô≈ºary)
- Cele objƒôto≈õciowe (wymiary cia≈Ça)
- Cele kondycyjne (dystans, czas)
- Cele nawyk√≥w (czƒôstotliwo≈õƒá trening√≥w)

**Gamifikacja**:
- System punkt√≥w za osiƒÖgniƒôcia
- Odznaki za milestones
- Streak counters (dni z rzƒôdu)
- Rankingi miƒôdzy sportowcami
- Wyzwania grupowe

---

## BEZPIECZE≈ÉSTWO

### Bezpiecze≈Ñstwo Danych

**Szyfrowanie**:
- Has≈Ça hashowane z bcryptjs (salt rounds: 10)
- HTTPS wymuszane w produkcji
- JWT tokens z expiration time
- Secure cookies z httpOnly flag

**Walidacja Danych**:
```typescript
// Zod schemas dla wszystkich formularzy
const userRegistrationSchema = z.object({
  name: z.string().min(2).max(50),
  email: z.string().email(),
  password: z.string().min(8).regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/),
  role: z.enum(['athlete', 'trainer', 'admin'])
});
```

**Ochrona API**:
- Rate limiting na wszystkich endpoints
- CORS configuration
- Input sanitization
- SQL injection prevention (NoSQL injection)
- XSS protection

### Autoryzacja na poziomie danych

**Role-based access control (RBAC)**:
```typescript
// Middleware sprawdzajƒÖce uprawnienia
const checkPermissions = (requiredRole: UserRole) => {
  return (req: NextRequest) => {
    const userRole = getUserRoleFromToken(req);
    if (!hasAccess(userRole, requiredRole)) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 403 });
    }
  };
};
```

**Data isolation**:
- Sportowcy widzƒÖ tylko swoje dane
- Trenerzy widzƒÖ dane swoich sportowc√≥w
- Administratorzy majƒÖ dostƒôp do wszystkich danych
- Soft delete dla krytycznych danych

### Prywatno≈õƒá

**GDPR Compliance**:
- Consent management system
- Right to be forgotten (data deletion)
- Data export functionality
- Privacy policy i terms of service
- Cookie consent banner

**Dane wra≈ºliwe**:
- Pomiary cia≈Ça (opcjonalne udostƒôpnianie trenerowi)
- Zdjƒôcia progress (szyfrowane storage)
- Dane zdrowotne (medical disclaimers)
- Lokalizacja GPS (consent required)

---

## WYDAJNO≈öƒÜ I SKALOWANIE

### Optymalizacje Frontend

**Next.js Optimizations**:
- Image optimization z next/image
- Automatic code splitting
- Static generation dla stron publicznych
- Incremental static regeneration (ISR)
- Edge functions dla geolocation

**Bundle optimizations**:
```typescript
// next.config.ts
const nextConfig = {
  experimental: {
    turbo: {
      loaders: {
        '.svg': ['@svgr/webpack']
      }
    }
  },
  images: {
    domains: ['firebasestorage.googleapis.com'],
    formats: ['image/webp', 'image/avif']
  }
}
```

**Performance monitoring**:
- Core Web Vitals tracking
- Runtime performance monitoring
- Bundle analyzer reports
- Lighthouse CI integration

### Backend Performance

**Database optimizations**:
```typescript
// Indexy MongoDB dla czƒôstych queries
db.users.createIndex({ "email": 1 }, { unique: true })
db.workoutLogs.createIndex({ "athleteId": 1, "endTime": -1 })
db.conversations.createIndex({ "participants": 1, "updatedAt": -1 })
```

**Caching strategy**:
- Redis dla session cache
- CDN dla statycznych zasob√≥w
- Browser caching headers
- API response caching

**Scaling considerations**:
- Database sharding po userId
- Horizontal scaling z load balancerem
- Microservices architecture (przysz≈Ço≈õƒá)
- Message queues dla heavy operations

### Monitoring i Logging

**Application monitoring**:
- Error tracking (Sentry integration)
- Performance monitoring (APM)
- User analytics (privacy-focused)
- Health checks endpoints

**Logging strategy**:
```typescript
// Structured logging
logger.info('User login', {
  userId: user.id,
  timestamp: new Date().toISOString(),
  userAgent: req.headers['user-agent'],
  success: true
});
```

---

## TESTOWANIE

### Strategy Testowania

**Poziomy test√≥w**:
1. **Unit tests** - Komponenty, funkcje, hooki
2. **Integration tests** - API routes, database operations
3. **E2E tests** - User flows, critical paths
4. **Visual regression tests** - UI consistency

### Testing Stack

**Frontend testing**:
```json
{
  "devDependencies": {
    "@testing-library/react": "^13.4.0",
    "@testing-library/jest-dom": "^5.16.5",
    "jest": "^29.7.0",
    "jest-environment-jsdom": "^29.7.0",
    "cypress": "^13.6.0"
  }
}
```

**Przyk≈Çad testu komponentu**:
```typescript
// __tests__/components/nav.test.tsx
describe('AppNav', () => {
  it('shows correct navigation items for athlete role', () => {
    const mockUser = { uid: '123', role: 'athlete' };
    render(
      <AuthProvider value={{ user: mockUser }}>
        <AppNav />
      </AuthProvider>
    );

    expect(screen.getByText('Panel Sportowca')).toBeInTheDocument();
    expect(screen.getByText('Zapisz Trening')).toBeInTheDocument();
    expect(screen.queryByText('Moi Sportowcy')).not.toBeInTheDocument();
  });
});
```

### API Testing

**Jest dla API routes**:
```typescript
// __tests__/api/auth/register.test.ts
describe('/api/auth/register', () => {
  beforeEach(async () => {
    await clearDatabase();
  });

  it('creates new user with valid data', async () => {
    const userData = {
      name: 'Test User',
      email: 'test@example.com',
      password: 'StrongPassword123',
      role: 'athlete'
    };

    const response = await fetch('/api/auth/register', {
      method: 'POST',
      body: JSON.stringify(userData)
    });

    expect(response.status).toBe(201);
    const data = await response.json();
    expect(data.user.email).toBe(userData.email);
  });
});
```

### E2E Testing

**Cypress dla user flows**:
```typescript
// cypress/e2e/athlete-workout-flow.cy.ts
describe('Athlete Workout Flow', () => {
  it('allows athlete to log a workout', () => {
    cy.login('athlete@example.com', 'password');
    cy.visit('/athlete/log');

    cy.get('[data-cy=workout-name]').type('Push Day');
    cy.get('[data-cy=add-exercise]').click();
    cy.get('[data-cy=exercise-select]').select('Wyciskanie sztangi');
    cy.get('[data-cy=sets-input]').type('3');
    cy.get('[data-cy=reps-input]').type('12');
    cy.get('[data-cy=weight-input]').type('80');

    cy.get('[data-cy=save-workout]').click();
    cy.url().should('include', '/athlete/history');
    cy.get('[data-cy=workout-list]').should('contain', 'Push Day');
  });
});
```

### Performance Testing

**Lighthouse CI**:
```json
{
  "ci": {
    "collect": {
      "url": ["http://localhost:9002"],
      "numberOfRuns": 3
    },
    "assert": {
      "assertions": {
        "categories:performance": ["error", {"minScore": 0.9}],
        "categories:accessibility": ["error", {"minScore": 0.9}]
      }
    }
  }
}
```

---

## WDRO≈ªENIE

### Environment Setup

**Development**:
- Local MongoDB instance
- Firebase Emulator Suite
- Hot reload z Turbopack
- Source maps enabled

**Staging**:
- MongoDB Atlas (shared cluster)
- Firebase Authentication (development project)
- Build optimization
- Error monitoring

**Production**:
- MongoDB Atlas (dedicated cluster)
- Firebase Authentication (production project)
- CDN distribution
- Full monitoring stack

### Build Process

**CI/CD Pipeline**:
```yaml
# .github/workflows/deploy.yml
name: Deploy to Production
on:
  push:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
      - run: npm ci
      - run: npm run typecheck
      - run: npm run lint
      - run: npm run test
      - run: npm run build

  deploy:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to Vercel
        uses: vercel/action@v1
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
```

### Deployment Platforms

**Vercel (Recommended)**:
- Zero-config Next.js deployment
- Automatic HTTPS
- Edge functions support
- Built-in analytics
- Preview deployments

**Alternatywne opcje**:
- AWS Amplify
- Netlify
- Digital Ocean App Platform
- Self-hosted (Docker)

### Database Migration Strategy

**Schema versioning**:
```typescript
// migrations/001-initial-schema.ts
export const up = async (db: Db) => {
  await db.createCollection('users');
  await db.collection('users').createIndex({ email: 1 }, { unique: true });

  await db.createCollection('workout-logs');
  await db.collection('workout-logs').createIndex({ athleteId: 1, endTime: -1 });
};
```

### Monitoring i Alerting

**Production monitoring**:
- Uptime monitoring (UptimeRobot/Pingdom)
- Error tracking (Sentry)
- Performance monitoring (New Relic/DataDog)
- Database monitoring (MongoDB Atlas)

**Alerting rules**:
- API error rate > 5%
- Response time > 2 seconds
- Database connection failures
- Memory usage > 80%

### Backup Strategy

**Database backups**:
- Daily automated backups (MongoDB Atlas)
- Point-in-time recovery
- Cross-region replication
- Backup testing quarterly

**File storage**:
- Firebase Storage automated backups
- Redundant storage across regions
- Versioning for critical files

---

## ROZSZERZENIA I PRZYSZ≈ÅY ROZW√ìJ

### Planowane Funkcjonalno≈õci

**Mobile App**:
- React Native aplikacja
- Offline-first architecture
- Push notifications
- Native camera integration
- Apple Health/Google Fit sync

**Advanced AI Features**:
- Computer vision dla analizy formy
- Personalized workout recommendations
- Injury prevention algorithms
- Nutritional analysis z camera

**Social Features**:
- Public workout sharing
- Community challenges
- Social leaderboards
- Workout buddy matching

**Enterprise Features**:
- Gym management system
- Multi-location support
- Trainer certification tracking
- Payment processing integration

### API Extensions

**Webhook system**:
```typescript
// Webhooks dla external integrations
POST /api/webhooks/workout-completed
POST /api/webhooks/goal-achieved
POST /api/webhooks/measurement-updated
```

**Third-party integrations**:
- Strava sync
- MyFitnessPal integration
- Fitbit/Apple Watch data
- Spotify workout playlists

### Microservices Architecture

**Planned services**:
- User Management Service
- Workout Engine Service
- Notification Service
- Analytics Service
- File Processing Service

**Message queues**:
- Redis pub/sub
- Event-driven architecture
- Async processing
- Scalable task management

---

## KONTAKT I WSPARCIE

### Development Team

**Roles i Odpowiedzialno≈õci**:
- **Frontend Developer** - UI/UX, React components
- **Backend Developer** - API, Database, Authentication
- **DevOps Engineer** - Deployment, Monitoring, Performance
- **QA Engineer** - Testing, Quality assurance
- **Product Manager** - Requirements, Roadmap

### Dokumentacja

**Zasoby**:
- Technical documentation (ten plik)
- API documentation (Postman/Swagger)
- Component library (Storybook)
- User guides i tutorials
- Video demonstrations

### Issue Tracking

**GitHub Issues**:
- Bug reports template
- Feature requests template
- Performance issues
- Documentation updates

**Labels system**:
- `bug` - B≈Çƒôdy do naprawy
- `feature` - Nowe funkcjonalno≈õci
- `enhancement` - Ulepszenia istniejƒÖcych funkcji
- `documentation` - Aktualizacje dokumentacji
- `performance` - Optymalizacje wydajno≈õci
- `security` - Kwestie bezpiecze≈Ñstwa

---

## APPENDIX

### U≈ºyte Ikony (Lucide React)

**Nawigacja**:
- `LayoutDashboard` - Dashboard
- `PlusSquare` - Dodawanie
- `CalendarDays` - Kalendarz
- `MessageSquare` - Chat
- `Library` - Biblioteki
- `Dumbbell` - ƒÜwiczenia
- `Users` - U≈ºytkownicy
- `User` - Profil

**Funkcjonalne**:
- `History` - Historia
- `Trophy` - Cele
- `Footprints` - Bieganie
- `Salad` - Dieta
- `Ruler` - Pomiary
- `Map` - Mapa
- `BookOpen` - Wiedza

### Kolory (Tailwind CSS)

**Primary Colors**:
- `primary` - G≈Ç√≥wny kolor akcji
- `secondary` - Drugorzƒôdny kolor
- `accent` - Kolor akcentujƒÖcy
- `muted` - Wyciszony tekst

**Status Colors**:
- `destructive` - B≈Çƒôdy, usuwanie
- `success` - Sukces, pozytywne akcje
- `warning` - Ostrze≈ºenia
- `info` - Informacje

### Responsive Breakpoints

```css
/* Tailwind CSS breakpoints */
sm: '640px'   /* Small devices (phones) */
md: '768px'   /* Medium devices (tablets) */
lg: '1024px'  /* Large devices (desktops) */
xl: '1280px'  /* Extra large devices */
2xl: '1536px' /* XXL devices */
```

### Konwencje Nazewnictwa

**Pliki i foldery**:
- kebab-case dla folder√≥w: `muscle-groups`
- PascalCase dla komponent√≥w: `WorkoutLog.tsx`
- camelCase dla hooks: `useWorkoutData.tsx`
- UPPER_CASE dla sta≈Çych: `API_ENDPOINTS`

**Database collections**:
- Plural noun: `users`, `exercises`, `workout-logs`
- kebab-case dla multi-word: `body-measurements`
- Consistency z API endpoints

---

*Ostatnia aktualizacja: 30.10.2025*
*Wersja dokumentacji: 1.0*
*Kontakt: krystian@gymprogress.pl*
